})
df_ordinal <- read_csv2("dados/brutos/psicologia.csv")
glimpse(df_ordinal)
df_ordinal <- df_ordinal |>
mutate_at(vars(matches(".\\d+")), \(x) {
fct(
as.character(x),
levels = paste(0:5)
)
})
table(df_ordinal$A1, df_ordinal$A2)
df_ordinal |>
summarise(
gk = GoodmanKruskalGamma(A1, A2)
)
df_16f <- read_csv2("dados/brutos/psicologia.csv")
df_16f <- df_16f |>
mutate(
A1 = fct(as.character(A1), levels = paste(0:5)),
A2 = fct(as.character(A2), levels = paste(0:5))
)
df_16f |>
summarise(
gk = GoodmanKruskalGamma(A1, A2)
)
GoodmanKruskalGamma(df_ordinal$A1, df_ordinal$A2)
GoodmanKruskalGamma(df_ordinal$A1, df_ordinal$A2, conf.level = 0.95)
library(pacman)
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
DescTools, tidyverse
)
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
dados,
DescTools, tidyverse
)
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
dados,
janitor,
DescTools, tidyverse
)
df_iris <- clean_names(dados_iris)
glimpse(df_iris)
tab <- group_by(especies) |>
summarise(
var = var(comprimento_sepala)
)
tab <- df_iris |>
group_by(especies) |>
summarise(
var = var(comprimento_sepala)
)
tab
tab <- df_iris |>
group_by(especies) |>
summarise(
var = var(comprimento_sepala),
freq = n()
)
tab
df_iris <- clean_names(dados_iris)
glimpse(df_iris)
tab <- df_iris |>
group_by(especies) |>
summarise(
var = var(comprimento_sepala),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
r2 <- 1 - var_bar / var(df_iris$comprimento_sepala)
r2
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var(df_iris$comprimento_sepala)
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var({{data}}${{y}})
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
with(
{{data}},
1 - var_bar / var({{y}})
)
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var(.data[[y]])
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var(.data[[{{y}}]])
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var(.data[[{{.y}}]])
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var({{.data}}[[{{.y}}]])
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var(.data[[{{.y}}]])
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / var(.data${{.y}})
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(.data, var = var{{.y}})$var
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{.data}}, var = var{{.y}})$var
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{.data}}, var = var{{.y}})$var
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{.data}}, var = var{{.y}})$var
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{data}}, var = var{{y}})$var
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{data}}, var = var{{y}})$var
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
s2 <- summarise({{data}}, var = var{{y}})$var
s2 <- summarise({{data}}, var = var{{y}})
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
s2 <- summarise(data, var = var{{y}})
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
s2 <- summarise(data, var = var{{y}})
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
}
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
sm
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var / summarise(data, s2 = var({{y}}))
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
1 - var / sm
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
sm
}
r2(df_iris, especies, comprimento_sepala)
class(r2(df_iris, especies, comprimento_sepala))
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
sm$s2
}
r2(df_iris, especies, comprimento_sepala)
class(r2(df_iris, especies, comprimento_sepala))
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
R2 <- function(data, x, y) {
summary(lm({{y}} ~ {{x}}, data = data))$r.squared
}
R2(df_iris, especies, comprimento_sepala)
R2 <- function(data, x, y) {
summary(lm(!!y ~ !!x, data = data))$r.squared
}
R2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
salvador <- read_excel("dados/brutos/salvador.xlsx")
salvador <- read_excel("dados/brutos/salvador.xlsx")
salvador <- read_excel("dados/brutos/salvador.xlsx")
df_iris <- clean_names(dados_iris)
glimpse(df_iris)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
PseudoR2(lm(nu_nota_mt ~ tp_sexo, data = salvador))
PseudoR2(lm(nu_nota_mt ~ tp_sexo, data = salvador))
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(compriemnto_sepala ~ especies, data = df_iris))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(compriemnto_sepala ~ especies, data = df_iris))$adj.r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_escola, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$adj.r.squared
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
dados,
janitor,
psycho,
DescTools, tidyverse
)
get_R2(lm(comprimento_sepala ~ especies, data = df_iris))
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
dados,
janitor,
psycho,
DescTools, tidyverse
)
get_R2(lm(comprimento_sepala ~ especies, data = df_iris))
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_escola, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$adj.r.squared
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
companhia <- read_excel("dados/brutos/companhia_MB.xlsx")
glimpse(companhia)
ggplot(companhia) +
geom_boxplo(aes(x = procedencia, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = procedencia, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = escolaridade, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = escolaridade, y = numero_filhos))
ggplot(companhia) +
geom_boxplot(aes(x = estado_civil, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = estado_civil, y = idade))
summary(lm(idade ~ estado_civil, data = companhia))$adj.r.squared
ggplot(companhia) +
geom_boxplot(aes(x = procedencia, y = idade))
summary(lm(idade ~ estado_civil, data = companhia))$adj.r.squared
ggplot(companhia) +
geom_boxplot(aes(x = procedencia, y = idade))
summary(lm(idade ~ estado_civil, data = companhia))$adj.r.squared
summary(lm(idade ~ procedencia, data = companhia))$adj.r.squared
ggplot(companhia) +
geom_boxplot(aes(x = escolaridade, y = idade))
summary(lm(idade ~ escolaridade, data = companhia))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_sexo, y = nu_nota_mt))
ggplot(salvador) +
geom_boxplot(aes(x = tp_estado_civil, y = nu_nota_mt))
summary(lm(idade ~ tp_estado_civil, data = companhia))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_estado_civil, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_estado_civil, data = salvador))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_estado_civil, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_sexo, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_cor_raca, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
