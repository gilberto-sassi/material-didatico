var_bar
1 - var_bar / var(.data${{.y}})
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(.data, var = var{{.y}})$var
r2(df_iris, especies, comprimento_sepala)
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{.data}}, var = var{{.y}})$var
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{.data}}, var = var{{.y}})$var
r2 <- function(.data, .x, .y) {
tab <- group_by({{.data}}, {{.x}}) |>
summarise(
var = var({{.y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{.data}}, var = var{{.y}})$var
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{data}}, var = var{{y}})$var
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise({{data}}, var = var{{y}})$var
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
s2 <- summarise({{data}}, var = var{{y}})$var
s2 <- summarise({{data}}, var = var{{y}})
r2 <- function(data, x, y) {
tab <- group_by({{data}}, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
s2 <- summarise(data, var = var{{y}})
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
s2 <- summarise(data, var = var{{y}})
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
}
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
sm
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var / summarise(data, s2 = var({{y}}))
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
1 - var / sm
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
sm
}
r2(df_iris, especies, comprimento_sepala)
class(r2(df_iris, especies, comprimento_sepala))
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
sm <- summarise(data, s2 = var({{y}}))
sm$s2
}
r2(df_iris, especies, comprimento_sepala)
class(r2(df_iris, especies, comprimento_sepala))
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
R2 <- function(data, x, y) {
summary(lm({{y}} ~ {{x}}, data = data))$r.squared
}
R2(df_iris, especies, comprimento_sepala)
R2 <- function(data, x, y) {
summary(lm(!!y ~ !!x, data = data))$r.squared
}
R2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
salvador <- read_excel("dados/brutos/salvador.xlsx")
salvador <- read_excel("dados/brutos/salvador.xlsx")
salvador <- read_excel("dados/brutos/salvador.xlsx")
df_iris <- clean_names(dados_iris)
glimpse(df_iris)
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
PseudoR2(lm(nu_nota_mt ~ tp_sexo, data = salvador))
PseudoR2(lm(nu_nota_mt ~ tp_sexo, data = salvador))
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(compriemnto_sepala ~ especies, data = df_iris))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(compriemnto_sepala ~ especies, data = df_iris))$adj.r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_escola, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$adj.r.squared
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
dados,
janitor,
psycho,
DescTools, tidyverse
)
get_R2(lm(comprimento_sepala ~ especies, data = df_iris))
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
dados,
janitor,
psycho,
DescTools, tidyverse
)
get_R2(lm(comprimento_sepala ~ especies, data = df_iris))
r2 <- function(data, x, y) {
tab <- group_by(data, {{x}}) |>
summarise(
var = var({{y}}),
freq = n()
)
var_bar <- sum(tab$var * tab$freq) / sum(tab$freq)
var_bar
1 - var_bar / summarise(data, s2 = var({{y}}))$s2
}
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(salvador, tp_sexo, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
r2(salvador, tp_escola, nu_nota_mt)
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$r.squared
summary(lm(nu_nota_mt ~ tp_escola, data = salvador))$adj.r.squared
r2(df_iris, especies, comprimento_sepala)
summary(lm(comprimento_sepala ~ especies, data = df_iris))$r.squared
summary(lm(comprimento_sepala ~ especies, data = df_iris))$adj.r.squared
companhia <- read_excel("dados/brutos/companhia_MB.xlsx")
glimpse(companhia)
ggplot(companhia) +
geom_boxplo(aes(x = procedencia, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = procedencia, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = escolaridade, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = escolaridade, y = numero_filhos))
ggplot(companhia) +
geom_boxplot(aes(x = estado_civil, y = salario))
ggplot(companhia) +
geom_boxplot(aes(x = estado_civil, y = idade))
summary(lm(idade ~ estado_civil, data = companhia))$adj.r.squared
ggplot(companhia) +
geom_boxplot(aes(x = procedencia, y = idade))
summary(lm(idade ~ estado_civil, data = companhia))$adj.r.squared
ggplot(companhia) +
geom_boxplot(aes(x = procedencia, y = idade))
summary(lm(idade ~ estado_civil, data = companhia))$adj.r.squared
summary(lm(idade ~ procedencia, data = companhia))$adj.r.squared
ggplot(companhia) +
geom_boxplot(aes(x = escolaridade, y = idade))
summary(lm(idade ~ escolaridade, data = companhia))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_sexo, y = nu_nota_mt))
ggplot(salvador) +
geom_boxplot(aes(x = tp_estado_civil, y = nu_nota_mt))
summary(lm(idade ~ tp_estado_civil, data = companhia))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_estado_civil, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_estado_civil, data = salvador))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_estado_civil, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_sexo, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_sexo, data = salvador))$adj.r.squared
ggplot(salvador) +
geom_boxplot(aes(x = tp_cor_raca, y = nu_nota_mt))
summary(lm(nu_nota_mt ~ tp_cor_raca, data = salvador))$adj.r.squared
r2(salvador, tp_cor_raca, nu_nota_mt)
library(pacman)
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
dados,
janitor,
psycho,
DescTools, tidyverse
)
p_load(
readxl, writexl, e1071, lettervalue, KbMvtSkew,
scales, patchwork,
mvtnorm,
dados,
janitor,
psycho,
DescTools, tidyverse
)
?mvtnorm::rmvnorm()
media <- c(0, 0)
amostra <- rmvnorm(tamanho, media, rbind(c(1, rho), c(rho, 1)))
# tamanho das amostras
tamanho <- 1000
media <- c(0, 0)
rho <- 0.95
amostra <- rmvnorm(tamanho, media, rbind(c(1, rho), c(rho, 1)))
df_positivo <- tibble(
x = amostra[, 1],
y = amostra[, 2],
)
View(df_positivo)
ggplot(df_positivo, aes(x, y)) +
geom_point()
ggplot(df_positivo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0)
?lims
ggplot(df_positivo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5))
ggplot(df_positivo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Associação positiva")
ggplot(df_positivo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Associação positiva")+
theme_minimal()
rho <- -0.95
amostra <- rmvnorm(tamanho, media, rbind(c(1, rho), c(rho, 1)))
df_negativo <- tibble(
x = amostra[, 1],
y = amostra[, 2],
)
negativo <- ggplot(df_negativo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Associação positiva") +
theme_minimal()
negativo
rho <- 0
amostra <- rmvnorm(tamanho, media, rbind(c(1, rho), c(rho, 1)))
df_nulo <- tibble(
x = amostra[, 1],
y = amostra[, 2],
)
nulo <- ggplot(df_nulo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Associação positiva") +
theme_minimal()
nulo
negativo <- ggplot(df_negativo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Associação negativa") +
theme_minimal()
negativo
positivo + negativo + nulo
rho <- 0.95
amostra <- rmvnorm(tamanho, media, rbind(c(1, rho), c(rho, 1)))
df_positivo <- tibble(
x = amostra[, 1],
y = amostra[, 2],
)
positivo <- ggplot(df_positivo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Associação positiva") +
theme_minimal()
rho <- -0.95
amostra <- rmvnorm(tamanho, media, rbind(c(1, rho), c(rho, 1)))
df_negativo <- tibble(
x = amostra[, 1],
y = amostra[, 2],
)
negativo <- ggplot(df_negativo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Associação negativa") +
theme_minimal()
negativo
rho <- 0
amostra <- rmvnorm(tamanho, media, rbind(c(1, rho), c(rho, 1)))
df_nulo <- tibble(
x = amostra[, 1],
y = amostra[, 2],
)
nulo <- ggplot(df_nulo, aes(x, y)) +
geom_point() +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
lims(x = c(-5, 5), y = c(-5, 5)) +
labs(title = "Sem associação.") +
theme_minimal()
nulo
positivo + negativo + nulo
?cor
?cor.test
cor.test(dados_iris$comprimento_sepala, dados_iris$comprimento_petala)
# teste
exams2moodle(glue("{path}/enunciado.Rmd"),
n = 5,
verbose = TRUE,
dir = glue("{path}"),
name = "associacao_quali_dados_teste")
pacman::p_load(
glue, exams
)
path <- "banco-itens/associacao_quali_dados"
# teste
exams2moodle(glue("{path}/enunciado.Rmd"),
n = 5,
verbose = TRUE,
dir = glue("{path}"),
name = "associacao_quali_dados_teste")
# teste
exams2moodle(glue("{path}/enunciado.Rmd"),
n = 5,
verbose = TRUE,
dir = glue("{path}"),
name = "associacao_quali_dados_teste")
source("~/Insync/sassi.pereira.gilberto@gmail.com/Google Drive/atividade_didatica/material-didatico/analise-de-dados/banco-itens/associacao_quali_dados/exportacao.R")
# real
exams2moodle(glue("{path}/enunciado.Rmd"),
n = 250,
verbose = TRUE,
dir = glue("{path}"),
name = "associacao_quali_dados")
source("~/Insync/sassi.pereira.gilberto@gmail.com/Google Drive/atividade_didatica/material-didatico/analise-de-dados/banco-itens/associacao_quali_dados/exportacao.R")
# real
exams2moodle(glue("{path}/enunciado.Rmd"),
n = 80,
verbose = TRUE,
dir = glue("{path}"),
name = "associacao_quali_dados")
